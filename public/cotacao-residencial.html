<!DOCTYPE html>
<html>

<head>
    <title>Formulário de três etapas</title>

    <!--CSS-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/14.7.0/nouislider.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.0/themes/base/jquery-ui.css" />
    <link rel="stylesheet" href="./src/css/custom.css" />

    <!--Javascript-->
</head>

<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">
                <a class="navbar-brand" href="planos.html">Prime Secure</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="#">Item1</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Item2</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <div class="container bg-gradiente">
        <div class="row">
            <div class="col-md-6">
                <div class="background-image">
                    <!-- Coloque aqui o código HTML da sua imagem com overlay -->
                </div>
            </div>
            <div class="col-md-6">
                <div>
                    <!-- Container Formulário-->
                    <div class="container container-form col-12 mx-auto">
                        <form action="planos.html" id="form" method="POST">
                            <div>
                                <!-- Inicio da Etapa 1 -->
                                <div id="step-1" class="form-step active">
                                    <h2 class="text-center mt-8">
                                        Para Iniciar Preencha Seus Dados:
                                    </h2>

                                    <div class="row">
                                        <div class="col">
                                            <div class="form-group">
                                                <label for="cpf">CPF: </label>
                                                <input type="text" class="form-control col" id="cpf" name="cpf" required
                                                    minlength="11" maxlength="14" />
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div class="form-group">
                                                <label for="nome">Nome:</label>
                                                <input type="text" class="form-control col nome" id="nome" name="nome"
                                                    minlength="1" maxlength="160" required />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <div class="form-group">
                                                <label for="numerotelefone">Celular ou Telefone:</label>
                                                <input type="text" class="form-control col numerotelefone"
                                                    id="numerotelefone" name="numerotelefone" minlength="10"
                                                    maxlength="11" placeholder="(DDD) 00000-0000" required />
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div class="form-group">
                                                <label for="tipotelefone">Tipo de Telefone</label>
                                                <select class="form-control" id="tipotelefone">
                                                    <option value="0">Telefone Celular</option>
                                                    <option value="1">Telefone Fixo</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="datanascimento">Data de Nascimento</label>
                                                <input type="text" class="form-control col datanascimento"
                                                    id="datanascimento" name="datanascimento" minlength="10"
                                                    maxlength="10" placeholder="DD/MM/YYYY" autocomplete="off"
                                                    required />
                                            </div>
                                        </div>
                                    </div>

                                    <button type="button" class="btn btn-primary next-step" id="next-step"
                                        style="width: 100%">
                                        Iniciar Cotação
                                    </button>
                                </div>
                                <!-- Fim da Etapa 1-->

                                <!-- Etapa 2 -->
                                <div id="step-2" style="display: none" class="form-step">
                                    <h2 class="text-center">Dados de Endereço do Imóvel</h2>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="cep">Cep:</label>
                                                <input type="text" class="form-control col cep" id="cep" name="cep"
                                                    minlength="8" maxlength="8" required />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <div class="form-group">
                                                <label for="logradouro">Endereço:</label>
                                                <input type="text" class="form-control col logradouro" id="logradouro"
                                                    name="logradouro" minlength="1" maxlength="200" required />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <div class="form-group">
                                                <label for="tipo">Tipo de Residência</label>
                                                <select class="form-control tipo" id="tipo">
                                                    <option value="0">Casa</option>
                                                    <option value="1">Apartamento</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <div class="form-group">
                                                <label for="numero">Nº do Imóvel</label>
                                                <input type="number" class="form-control col numero" id="numero"
                                                    name="numero" minlength="1" maxlength="9999" pattern="^[0-9]{1,4}$"
                                                    required />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <div class="form-group">
                                                <label for="bairro">Bairro:</label>
                                                <input type="text" class="form-control col bairro" id="bairro"
                                                    name="bairro" minlength="1" maxlength="40" required />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col">
                                            <div class="form-group">
                                                <label for="cidade">Cidade:</label>
                                                <input type="text" class="form-control col cidade" id="cidade"
                                                    name="cidade" minlength="1" maxlength="40" required />
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label for="uf">Estado (UF):</label>
                                            <input type="text" class="form-control col uf" id="uf" name="uf" required />
                                        </div>
                                    </div>

                                    <button type="button" class="btn btn-secondary prev-step">
                                        Etapa anterior
                                    </button>
                                    <button type="button" class="btn btn-primary next-step" id="next-step">
                                        Avançar
                                    </button>
                                </div>
                                <!-- Fim da Etapa 2-->

                                <!-- Etapa 3 -->
                                <div id="step-3" style="display: none" class="form-step">
                                    <h2 class="text-center">
                                        Agora Você Pode Personalizar o Seu Seguro
                                    </h2>
                                    <!-- Input Cobertura de Incêndio -->
                                    <div class="row">
                                        <div class="col">
                                            <div class="form-group">
                                                <label for="valorcoberturaincendio" class="form-label">Cobertura de
                                                    Incêndio:</label>
                                                <div class="range-container">
                                                    <input type="range" class="form-range input-coberturas"
                                                        id="valorcoberturaincendio" min="1" max="10000000000" value="10"
                                                        step="100000000" />
                                                    <div class="range-value0">R$ 10.000</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- valorCoberturaSubstracaoBens -->
                                    <div class="row">
                                        <div class="col">
                                            <div class="form-group">
                                                <label for="valorcoberturasubstracaobens" class="form-label">Cobertura
                                                    Substração de Bens:</label>
                                                <div class="range-container">
                                                    <input type="range" class="form-range input-coberturas"
                                                        id="valorcoberturasubstracaobens" min="1" max="10000000000"
                                                        value="10" step="100000000" />
                                                    <div class="range-value1">R$ 10.000</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- valorCoberturaPagamentoAluguel -->
                                    <div class="row">
                                        <div class="col">
                                            <div class="form-group">
                                                <label for="valorcoberturapagamentoaluguel" class="form-label">Cobertura
                                                    Pagamento de Aluguel:</label>
                                                <div class="range-container">
                                                    <input type="range" class="form-range input-coberturas"
                                                        id="valorcoberturapagamentoaluguel" min="1" max="10000000000"
                                                        value="10" step="100000000" />
                                                    <div class="range-value2">R$ 10.000</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <button type="button" class="btn btn-secondary prev-step prev-step-3">
                                        Etapa anterior
                                    </button>
                                    <i class="fa fa-spinner fa-spin loading-icon" style="display: none"></i>
                                    <button type="submit" class="btn btn-success submit-form">
                                        Enviar formulário
                                    </button>
                                </div>
                                <!-- Fim da Etapa 3-->
                            </div>
                        </form>
                    </div>
                    <!-- Fim Container Formulário-->
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/14.7.0/nouislider.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/@tensorflow/tfjs-fetch"></script>
    <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-i18n/1.12.1/jquery-ui-i18n.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="./src/js/app.js"></script>
    <script src="./src/js/viaCep.js"></script>

    <script>
        //Api que guarda os dados do fomulario e envia para uma api com bearer token
        const submitForm = async (event) => {
            event.preventDefault();

            //Pega os dados do formulario
            const form = document.querySelector('#form');
            const formData = new FormData(form);

            //define as opções para a requisição
            const options = {
                method: 'POST',
                headers: {
                    'Authorization': 'Bearer YzIwMGEwNzYtZTZhZC00MGRhLThkYTktMDg0NmFiODkyNzI1Ojk3MTk0MWU4LTJlNGYtNDI3Ny05Y2YyLTRkOTNhZGU3NjVlZQ==',
                },
                body: formData
            };

            //faz a requisição
            const response = await fetch('https://portoapi-sandbox.portoseguro.com.br/re/residencial/v1/habitual/orcamentos', options);

            //verifica se a requisição foi bem sucedida
            if (response.ok) {
                const data = await response.json();
                console.log(data);
                // redireciona para a página desejada
                window.location.replace('planos.html');
            } else {
                console.error('Erro na Requisição', response.status, response.statusText);
            }
        }

        //Adiciona o evento de submit no formulario
        const form = document.querySelector('#form');
        form.addEventListener('submit', submitForm);
    </script>

    <script>
        const range0 = document.getElementById("valorcoberturaincendio");
        const rangeValue0 = document.querySelector(".range-value0");

        range0.addEventListener("input", () => {
            const valor = parseInt(range0.value);
            rangeValue0.innerHTML = `R$ ${valor}`;
        });
        const range1 = document.getElementById("valorcoberturasubstracaobens");
        const rangeValue1 = document.querySelector(".range-value1");

        range1.addEventListener("input", () => {
            const valor = parseInt(range1.value);
            rangeValue1.innerHTML = `R$ ${valor}`;
        });
        const range2 = document.getElementById("valorcoberturapagamentoaluguel");
        const rangeValue2 = document.querySelector(".range-value2");

        range2.addEventListener("input", () => {
            const valor = parseInt(range2.value);
            rangeValue2.innerHTML = `R$ ${valor}`;
        });
    </script>
</body>

</html>